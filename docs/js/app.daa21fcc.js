(function(t){function e(e){for(var s,i,o=e[0],u=e[1],l=e[2],m=0,f=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(t[s]=u[s]);c&&c(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],s=!0,o=1;o<r.length;o++){var u=r[o];0!==n[u]&&(s=!1)}s&&(a.splice(e--,1),t=i(i.s=r[0]))}return t}var s={},n={app:0},a=[];function i(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=s,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var c=u;a.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"04a0":function(t,e,r){},"0bbb":function(t,e,r){},"0f0b":function(t,e,r){"use strict";r("04a0")},1778:function(t,e,r){"use strict";r("cc10")},"1e1e":function(t,e,r){"use strict";r("ab1d")},"48e4":function(t,e,r){"use strict";r("4a50")},"4a50":function(t,e,r){},"4ca0":function(t,e,r){"use strict";r("64b2")},"54b9":function(t,e,r){"use strict";r("75ed")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var s=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"app-wrapper"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"app-wrapper__title"},[t._v("Realtime Chat")]),t.isLogin?r("Chat",{attrs:{currentUserId:t.curentUserId}}):r("Auth",{on:{onFormData:this.getFormDataHandler,onCurrentUser:this.getCurrentUserHandler}})],1)])])},a=[],i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"chat"},[r("ChatAside",{attrs:{users:t.users},on:{onCurrentDialog:t.getCurrentDialogHandler}}),r("ChatMain",{attrs:{currentDialog:this.currentDialog,totalUsers:this.getTotalUsers,currentUserId:t.currentUserId}})],1)},o=[],u=(r("a9e3"),r("4de4"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("aside",{staticClass:"chat-aside"},[r("h2",{staticClass:"chat-aside__title"},[t._v("Диалоги")]),r("ListDialogs",{attrs:{users:t.users},on:{onCurrentDialog:t.getCurrentDialogHandler}})],1)}),l=[],c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"chat-aside__list-dialogs list-dialogs"},t._l(t.users,(function(e,s){return r("ListDialogsItem",{key:s,attrs:{item:e},on:{onCurrentDialog:t.getCurrentDialogHandler}})})),1)},m=[],f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",{staticClass:"list-dialogs__item",on:{click:this.emitHandler}},[t._v(" "+t._s(t.item.name)+" ")])},d=[],g={name:"ListDialogsItem",props:{item:Object},methods:{emitHandler:function(){this.$emit("onCurrentDialog",this.item)}}},p=g,h=(r("0f0b"),r("2877")),v=Object(h["a"])(p,f,d,!1,null,null,null),_=v.exports,b={name:"ListDialogs",props:{users:Array},components:{ListDialogsItem:_},methods:{getCurrentDialogHandler:function(t){this.$emit("onCurrentDialog",t)}}},D=b,C=Object(h["a"])(D,c,m,!1,null,null,null),I=C.exports,O={name:"ChatAside",components:{ListDialogs:I},props:{users:Array},methods:{getCurrentDialogHandler:function(t){this.$emit("onCurrentDialog",t)}}},U=O,y=(r("f210"),Object(h["a"])(U,u,l,!1,null,null,null)),S=y.exports,w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("main",{staticClass:"chat-main"},[t.currentDialog?r("div",{staticClass:"chat-main__wrapper"},[r("h2",{staticClass:"chat-main__title"},[t._v(" "+t._s(t.currentDialog.name)+" ")]),r("hr"),r("ListMessage",{attrs:{messages:t.messages,currentUserId:t.currentUserId,currentDialog:t.currentDialog}}),r("Form",{attrs:{placeholder:"Введите сообщение"},on:{onFormData:this.getFormDataHandler}})],1):!t.currentDialog&&t.totalUsers?r("p",{staticClass:"chat-main__paragraph"},[t._v("Выберете диалог")]):r("p",{staticClass:"chat-main__paragraph"},[t._v("Добавьте пользователя. Для этого продублируйте вкладку в браузере")])])},j=[],L=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("form",{staticClass:"main-form",on:{submit:function(e){return e.preventDefault(),t.onSubmitHandler(e)}}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"textarea",attrs:{placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),r("Button",{attrs:{typeAttr:"submit"}},[t._v(" Отправить ")])],1)},x=[],M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("button",{staticClass:"btn",attrs:{type:t.typeAttr}},[t._t("default")],2)},H=[],F={props:{typeAttr:String}},$=F,A=(r("4ca0"),Object(h["a"])($,M,H,!1,null,null,null)),N=A.exports,E={name:"Form",props:{placeholder:String},data:function(){return{value:""}},components:{Button:N},methods:{onSubmitHandler:function(){var t={value:this.value};this.$emit("onFormData",t),this.value=""}}},J=E,P=(r("48e4"),Object(h["a"])(J,L,x,!1,null,null,null)),k=P.exports,T=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"list-messages"},t._l(t.messages,(function(e,s){return r("ListMessageItem",{key:s,attrs:{message:e,currentUserId:t.currentUserId,currentDialog:t.currentDialog}})})),1)},B=[],R=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",{staticClass:"list-messages__item",class:{"list-messages__item--my":t.addClassMyMessage}},[t._v(" "+t._s(t.message.messageInfo.textMessage)+" ")])},q=[],z={name:"ListMessageItem",props:{message:Object,currentUserId:Number,currentDialog:Object},computed:{addClassMyMessage:function(){return this.message.senderId===this.currentUserId}}},G=z,K=(r("1e1e"),Object(h["a"])(G,R,q,!1,null,null,null)),Q=K.exports,V={name:"ListMessage",components:{ListMessageItem:Q},props:{messages:Array,currentUserId:Number,currentDialog:Object}},W=V,X=(r("9e65"),Object(h["a"])(W,T,B,!1,null,null,null)),Y=X.exports,Z={name:"ChatMain",components:{Form:k,ListMessage:Y},props:{currentDialog:Object,totalUsers:Number,currentUserId:Number},data:function(){return{messages:[]}},updated:function(){var t=this;window.onstorage=function(e){return t.messages=JSON.parse(e.storageArea.messages)}},methods:{getFormDataHandler:function(t){this.saveLocalStorageCurrentDialog(t.value)},getMessagesLocalStorage:function(){this.messages=JSON.parse(window.localStorage.getItem("messages"))||[]},saveLocalStorageCurrentDialog:function(t){this.getMessagesLocalStorage();var e={senderId:this.currentUserId,messageInfo:{toAddresseeId:this.currentDialog.id,textMessage:t}},r=this.messages;r.unshift(e),window.localStorage.setItem("messages",JSON.stringify(r))}}},tt=Z,et=(r("54b9"),Object(h["a"])(tt,w,j,!1,null,null,null)),rt=et.exports,st={name:"Chat",components:{ChatAside:S,ChatMain:rt},props:{currentUserId:Number},data:function(){return{users:[],currentDialog:null}},created:function(){var t=this;window.onstorage=function(e){return t.users=JSON.parse(e.storageArea.users).filter((function(e){return e.id!==t.currentUserId}))},this.users=JSON.parse(localStorage.getItem("users")).filter((function(e){return e.id!==t.currentUserId}))},methods:{getCurrentDialogHandler:function(t){this.currentDialog=t}},computed:{getTotalUsers:function(){return this.users.length}}},nt=st,at=(r("1778"),Object(h["a"])(nt,i,o,!1,null,null,null)),it=at.exports,ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"auth"},[r("h2",{staticClass:"auth__title"},[t._v("Введите Ваше имя")]),r("Form",{attrs:{placeholder:"Андрей"},on:{onFormData:this.setFormDataHandler}})],1)},ut=[],lt={name:"Auth",components:{Form:k},data:function(){return{formData:{},users:[]}},methods:{setFormDataHandler:function(t){this.formData=t,this.emitFormDataHandler(),this.getUsersLocalStorage(),this.saveUsersLocalStorage(this.formData.value)},emitFormDataHandler:function(){this.$emit("onFormData",this.formData)},emitCurrentUser:function(){this.$emit("onCurrentUser",this.users[this.users.length-1])},getUsersLocalStorage:function(){this.users=JSON.parse(window.localStorage.getItem("users"))||[]},saveUsersLocalStorage:function(t){var e={id:Date.now(),name:t};this.users.push(e),window.localStorage.setItem("users",JSON.stringify(this.users)),this.emitCurrentUser()}}},ct=lt,mt=(r("7aca"),Object(h["a"])(ct,ot,ut,!1,null,null,null)),ft=mt.exports,dt={name:"App",components:{Chat:it,Auth:ft},data:function(){return{isLogin:!1,currentUserId:null}},methods:{getFormDataHandler:function(t){t.value?this.isLogin=!0:this.isLogin.false},getCurrentUserHandler:function(t){this.curentUserId=t&&t.id}}},gt=dt,pt=(r("cf25"),Object(h["a"])(gt,n,a,!1,null,null,null)),ht=pt.exports;s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(ht)}}).$mount("#app")},"64b2":function(t,e,r){},"75ed":function(t,e,r){},"7aca":function(t,e,r){"use strict";r("0bbb")},"97ac":function(t,e,r){},"9e65":function(t,e,r){"use strict";r("97ac")},a49f:function(t,e,r){},ab1d:function(t,e,r){},cc10:function(t,e,r){},cf25:function(t,e,r){"use strict";r("fea6")},f210:function(t,e,r){"use strict";r("a49f")},fea6:function(t,e,r){}});
//# sourceMappingURL=app.daa21fcc.js.map